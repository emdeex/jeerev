<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='content-type' content='text/html; charset=utf-8' />
    <title>DataTables demo</title>
    [JScript includes ui knockout eventsource datatables kodtb]
    [JScript coffee {
      viewModel =
        tableData: ko.observable []
        update: (data) ->
          t = @tableData();
          for row in data
            t = (e for e in t when e[0] != row[0])
          @tableData t.concat(data)
      ko.applyBindings viewModel
      $.eventsource
        url: 'events/table'
        message: (d) -> viewModel.update(d)
    }]
    [JScript wrap {
      var viewModel;
      viewModel = {
        tableData: ko.observable([]),
        update: function(data) {
          var e, row, t, _i, _len;
          t = this.tableData();
          for (_i = 0, _len = data.length; _i < _len; _i++) {
            row = data[_i];
            t = (function() {
              var _j, _len2, _results;
              _results = [];
              for (_j = 0, _len2 = t.length; _j < _len2; _j++) {
                e = t[_j];
                if (e[0] !== row[0]) {
                  _results.push(e);
                }
              }
              return _results;
            })();
          }
          return this.tableData(t.concat(data));
        }
      };
      ko.applyBindings(viewModel);
      $.eventsource({
        url: 'events/table',
        message: function(d) {
          return viewModel.update(d);
        }
      });
    }]
    <style type='text/css'>
      body { font-family: Verdana; font-size: 100%; }
      .main { width: 600px; }
      table { border: 1px solid #ccc; border-collapse: collapse; width: 100%; }
      td { padding: 0 3px; }
      tbody tr:nth-child(even) { background-color: #eee; }
    </style>
  </head>
  <body>
    <div class='main'>
      <table data-bind='dataTable: { data: tableData,
                                     options: { bJQueryUI: true } }'>
        <thead><tr>
          <th>Description</th>
          <th width='12%'>Value</th>
          <th width='12%'>Unit</th>
          <th width='16%'>Changed</th>
          <th width='16%'>Updated</th>
        </tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </body>
</html>
